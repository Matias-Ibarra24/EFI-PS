{% extends 'base.html' %}

{% block content %}
    <h2>{{ entrada.titulo }}</h2>
    <p>
    Categorías:
    {% for categoria in entrada.categorias %}
        <span class="badge badge-info">{{ categoria.nombre }}</span>
    {% else %}
        <span class="text-muted">Sin categorías</span>
    {% endfor %}
    </p>
    <p class="text-muted">
        Publicado por {{ entrada.autor.nombre_usuario }} el {{ entrada.fecha_creacion.strftime('%d/%m/%Y') }}
    </p>
    <p>{{ entrada.contenido }}</p>

    <hr>
    <h4>Comentarios</h4>
    <ul class="list-group mb-3">
    {% for comentario in entrada.comentarios %}
        <li class="list-group-item">
        <strong>{{ comentario.autor.nombre_usuario }}</strong>:
        {{ comentario.texto }}
        <br>
        <small class="text-muted">{{ comentario.fecha_creacion.strftime('%d/%m/%Y %H:%M') }}</small>
        </li>
    {% else %}
        <li class="list-group-item">No hay comentarios aún.</li>
    {% endfor %}
    </ul>

    {% if current_user.is_authenticated %}
    <form method="POST">
      <div class="mb-3">
        <label for="texto" class="form-label">Agregar comentario</label>
        <textarea name="texto" id="texto" class="form-control" required></textarea>
      </div>
      <button type="submit" class="btn btn-primary">Comentar</button>
    </form>
    {% else %}
    <p><a href="{{ url_for('login') }}">Inicia sesión</a> para comentar.</p>
    {% endif %}
{% endblock %}